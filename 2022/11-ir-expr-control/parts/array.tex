% array.tex

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \red{\bf 数组引用的中间代码翻译}

    \begin{align*}
      \text{声明}&: \teal{\text{int}\; a[2][3]} \\[12pt]
      \text{数组引用}&: \teal{x = a[1][2];\; a[1][2] = x}
    \end{align*}

    \pause
    \vspace{0.50cm}
    需要计算 $a[1][2]$ 相对于\blue{\bf 数组基地址} $a$ 的\purple{\bf 偏移地址}

    \pause
    \[
      addr(a[1][2]) = \blue{base} + \purple{1 \times 12 + 2 \times 4}
    \]

    \input{tables/array-types}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \[
      \teal{\text{int}\; a[2][3]}
    \]
    \vspace{-0.50cm}
    \fig{width = 0.85\textwidth}{figs/anno-type-width}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \green{\bf 综合属性 $L.array(.base):$ 数组基地址 (即, 数组名)}

    \fig{width = 0.65\textwidth}{figs/cfg-array}

    \purple{\bf 综合属性 $L.addr:$ 偏移地址}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{center}
%     \red{\bf 综合属性 $L.array:$ 数组名 \id 对应的符号表条目}

%     \fig{width = 0.85\textwidth}{figs/SDT-L-L-array}
%   \end{center}
% \end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{center}
%     \purple{\bf 综合属性 $L.type:$ (当前)元素类型}

%     \fig{width = 0.85\textwidth}{figs/SDT-L-L-type}
%   \end{center}
% \end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{center}
%     \blue{\bf 综合属性 $L.addr:$ (当前)偏移地址}

%     \fig{width = 0.85\textwidth}{figs/SDT-L-L-addr}
%   \end{center}
% \end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \fig{width = 0.90\textwidth}{figs/array-code}
    \vspace{-0.65cm}
    \[
      \teal{c + a[i][j]}
    \]
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.50\textwidth}{figs/array-c-type}
  \vspace{-0.20cm}
  \fig{width = 0.25\textwidth}{figs/array-c}
  \vspace{-0.20cm}
  \fig{width = 0.85\textwidth}{figs/array-c-ll}

  \pause
  \vspace{-0.20cm}
  \begin{center}
    \href{https://llvm.org/docs/GetElementPtr.html}{The Often Misunderstood GEP Instruction}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%